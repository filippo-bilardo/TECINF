### **4.11 Condivisione e Permessi delle Cartelle**

La condivisione e la gestione dei permessi delle cartelle sono funzionalit√† fondamentali di Windows che permettono di controllare l'accesso ai file e alle cartelle, sia per utenti locali che di rete.

---

#### **1. Concetti Base della Condivisione**

**Cos'√® la Condivisione:**
La condivisione permette di rendere accessibili file e cartelle ad altri utenti attraverso la rete, controllando chi pu√≤ accedere e cosa pu√≤ fare con i contenuti.

**Tipi di Condivisione:**
- **Condivisione locale**: Permessi per utenti dello stesso computer
- **Condivisione di rete**: Accesso da altri computer in rete
- **Condivisione avanzata**: Controllo dettagliato dei permessi

---

#### **2. Permessi di Base**

**Permessi Standard:**
- **Lettura**: Visualizzare file e cartelle
- **Scrittura**: Modificare o creare file
- **Esecuzione**: Avviare programmi o accedere a cartelle
- **Controllo completo**: Tutti i permessi inclusa la modifica dei permessi
- **Eliminazione**: Rimuovere file e cartelle

**Livelli di Accesso:**
- **Proprietario**: Ha controllo completo
- **Amministratore**: Pu√≤ modificare permessi
- **Utente standard**: Accesso limitato
- **Ospite**: Accesso molto limitato

---

#### **3. Condivisione Semplice**

**Passaggi per Condividere una Cartella:**

1. **Seleziona la Cartella:**
   - Fai clic destro sulla cartella da condividere
   - Seleziona **Propriet√†**

2. **Accedi alla Condivisione:**
   - Clicca sulla scheda **Condivisione**
   - Fai clic su **Condividi...**

3. **Scegli gli Utenti:**
   - Seleziona utenti dal menu a discesa
   - Oppure digita nomi utente specifici
   - Clicca **Aggiungi**

4. **Imposta i Permessi:**
   - **Lettura**: Solo visualizzazione
   - **Lettura/Scrittura**: Modifica consentita
   - **Rimuovi**: Elimina l'accesso

5. **Conferma:**
   - Clicca **Condividi**
   - Nota il percorso di rete mostrato

---

#### **4. Condivisione Avanzata**

**Accesso alla Condivisione Avanzata:**
1. Propriet√† della cartella ‚Üí **Condivisione**
2. Clicca **Condivisione avanzata...**
3. Spunta **Condividi la cartella**

**Impostazioni Avanzate:**
- **Nome condivisione**: Come appare in rete
- **Commento**: Descrizione della condivisione
- **Limite utenti**: Numero massimo di connessioni
- **Permessi**: Controllo dettagliato

**Tipi di Permessi Avanzati:**
- **Controllo completo**: Tutti i diritti
- **Modifica**: Lettura, scrittura, eliminazione
- **Lettura**: Solo visualizzazione

---

#### **5. Gestione Permessi di Sicurezza**

**Scheda Sicurezza:**
Permessi pi√π granulari per utenti e gruppi locali.

**Permessi Specifici:**
- **Attraversamento cartelle/esecuzione file**
- **Visualizzazione cartelle/lettura dati**
- **Lettura attributi ed attributi estesi**
- **Creazione file/scrittura dati**
- **Creazione cartelle/aggiunta dati**
- **Scrittura attributi ed attributi estesi**
- **Eliminazione sottocartelle e file**
- **Eliminazione**
- **Lettura permessi**
- **Modifica permessi**
- **Diventare proprietario**

**Ereditariet√†:**
- I permessi possono essere ereditati dalle cartelle genitore
- √à possibile bloccare o modificare l'ereditariet√†

---

#### **6. Condivisione in Rete**

**Prerequisiti:**
- Computer nella stessa rete
- Condivisione file e stampanti abilitata
- Firewall configurato correttamente

**Accesso alle Risorse Condivise:**
1. **Esplora File** ‚Üí **Rete**
2. Oppure digitare `\\NomeComputer` nella barra degli indirizzi
3. Inserire credenziali se richieste

**Mappatura Unit√† di Rete:**
1. **Questo PC** ‚Üí **Mappa unit√† di rete**
2. Scegli una lettera di unit√†
3. Inserisci il percorso: `\\NomeComputer\NomeCondivisione`
4. Spunta **Riconnetti all'accesso** per rendere permanente

---

#### **7. Gruppi Domestici (Versioni Precedenti)**

**Nota**: I Gruppi Domestici sono stati rimossi dalle versioni recenti di Windows, sostituiti da funzionalit√† pi√π semplici.

**Alternative Moderne:**
- Condivisione nelle vicinanze
- OneDrive per la sincronizzazione
- Condivisione diretta tra account Microsoft

---

#### **8. Risoluzione Problemi Comuni**

**Problemi di Accesso:**
- Verificare credenziali utente
- Controllare i permessi della cartella
- Assicurarsi che la condivisione sia abilitata
- Verificare le impostazioni del firewall

**Errori Comuni:**
- "Accesso negato": Permessi insufficienti
- "Risorsa non disponibile": Problema di rete o nome
- "Credenziali non valide": Username/password errati

**Comandi Utili:**
```cmd
net share                    # Mostra condivisioni attive
net use                      # Mostra unit√† mappate
net use Z: \\server\share    # Mappa unit√† di rete
```

---

#### **9. Sicurezza e Best Practices**

**Principi di Sicurezza:**
- **Principio del minimo privilegio**: Concedi solo i permessi necessari
- **Revisione regolare**: Controlla periodicamente i permessi
- **Documentazione**: Tieni traccia delle condivisioni
- **Backup**: Assicurati che i dati condivisi siano protetti

**Raccomandazioni:**
- Evita di condividere l'intera unit√† C:
- Usa password complesse per gli account
- Disabilita le condivisioni non necessarie
- Monitora l'accesso alle risorse sensibili

---

#### **10. Riepilogo**

La gestione dei permessi e della condivisione √® essenziale per:
- Proteggere dati sensibili
- Collaborare efficacemente
- Mantenere la sicurezza del sistema
- Organizzare l'accesso alle risorse

Comprendere questi concetti ti permetter√† di gestire l'accesso ai file in modo sicuro ed efficiente.

---

**Domande per Verificare la Comprensione:**
1. Qual √® la differenza tra condivisione semplice e avanzata?
2. Cosa significa "ereditariet√†" nei permessi?
3. Come si mappa un'unit√† di rete?
4. Quali sono i principi base della sicurezza nella condivisione file?

---

## üí° **Best Practice e Sicurezza Avanzata**

### ‚ú® Gestione Permessi Professionale
- **RBAC (Role-Based Access Control)**: Organizza utenti in gruppi con ruoli specifici
- **ACL granulari**: Usa Access Control Lists per controllo dettagliato
- **Auditing avanzato**: Monitora accessi e modifiche ai file sensibili  
- **Separazione privilegi**: Admin separati per gestione sistema vs dati

### ‚ö° Ottimizzazione Prestazioni
- **Cache condivisioni**: Configura cache lato client per prestazioni
- **Compressione SMB**: Abilita compressione per trasferimenti lenti
- **SMB3 encryption**: Usa crittografia per dati sensibili
- **Load balancing**: Distribuisci carichi su server multipli

### üîí Sicurezza Enterprise
1. **Domain policies**: Implementa Group Policy per controllo centralizzato
2. **BitLocker**: Crittografia a livello disco per protezione completa
3. **Rights Management**: Azure RMS per protezione documenti avanzata
4. **Zero Trust**: Verifica continua anche per accessi interni

---

## üéØ **Laboratori Pratici Avanzati**

### Lab 1: Ambiente Ufficio Simulato
**Obiettivo**: Configurare struttura permessi aziendale completa

1. **Crea struttura organizzativa:**
```
Azienda/
‚îú‚îÄ‚îÄ Amministrazione/      (Solo Admin + Contabilit√†)
‚îú‚îÄ‚îÄ Risorse_Umane/        (Solo HR + Admin)
‚îú‚îÄ‚îÄ Progetti/
‚îÇ   ‚îú‚îÄ‚îÄ Progetto_A/       (Team A + Project Manager)
‚îÇ   ‚îî‚îÄ‚îÄ Progetto_B/       (Team B + Project Manager)
‚îú‚îÄ‚îÄ Condiviso/
‚îÇ   ‚îú‚îÄ‚îÄ Templates/        (Tutti - Lettura)
‚îÇ   ‚îî‚îÄ‚îÄ Archivio/        (Tutti - Scrittura controllata)
‚îî‚îÄ‚îÄ IT_Support/          (Solo IT Admin)
```

2. **Configura gruppi utenti:**
   - Amministratori (Controllo completo)
   - Project Managers (Lettura/Scrittura progetti)
   - Team Members (Accesso limitato ai propri progetti)
   - Guests (Solo lettura documenti pubblici)

### Lab 2: Sicurezza Multi-Livello
**Obiettivo**: Implementare sicurezza a livelli multipli

1. **Livello 1 - Condivisione di rete:**
   - Configura condivisioni SMB con autenticazione
   - Implementa quote disco per utenti
   - Abilita auditing degli accessi

2. **Livello 2 - Permessi NTFS:**
   - Configura permessi granulari su file/cartelle
   - Testa ereditariet√† e sovrascrizioni
   - Implementa permessi espliciti vs ereditati

3. **Livello 3 - Crittografia:**
   - Abilita EFS (Encrypting File System)
   - Configura BitLocker per protezione disco
   - Testa recupero chiavi di crittografia

### Lab 3: Automazione e Monitoring
**Obiettivo**: Automatizzare gestione permessi e monitoraggio

1. **Script PowerShell per gestione automatica:**
```powershell
# Script per creazione struttura permessi automatica
param(
    [string]$BasePath,
    [string]$TeamName,
    [string[]]$TeamMembers
)

# Crea cartella team
$teamPath = Join-Path $BasePath $TeamName
New-Item -Path $teamPath -ItemType Directory -Force

# Configura permessi
$acl = Get-Acl $teamPath
foreach ($member in $TeamMembers) {
    $accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule($member, "FullControl", "ContainerInherit,ObjectInherit", "None", "Allow")
    $acl.SetAccessRule($accessRule)
}
Set-Acl -Path $teamPath -AclObject $acl
```

---

## üìù **Quiz Professionale Avanzato**

### Domanda 1
**Quale protocollo di condivisione supporta crittografia end-to-end nativamente?**

A) SMB 1.0  
B) SMB 2.0  
C) SMB 3.0+  
D) NFS  

### Domanda 2
**Cosa succede quando si nega esplicitamente un permesso che √® concesso tramite gruppo?**

A) Il permesso di gruppo prevale  
B) Il diniego esplicito prevale  
C) Si genera un errore  
D) Dipende dall'ordine di applicazione  

### Domanda 3
**Quale comando PowerShell mostra i permessi effettivi di un utente su una cartella?**

A) `Get-Acl`  
B) `Get-EffectiveAccess`  
C) `Test-Path`  
D) `Get-AuthorizationRule`  

### Domanda 4
**In un ambiente Active Directory, dove vengono tipicamente gestiti i permessi di rete?**

A) Local Security Policy  
B) Group Policy Objects (GPO)  
C) Registry Editor  
D) Computer Management  

### Domanda 5
**Quale tecnologia permette di proteggere file anche quando copiati su altri sistemi?**

A) NTFS Permissions  
B) Share Permissions  
C) EFS (Encrypting File System)  
D) Windows Rights Management  

### Domanda 6
**Cosa indica l'icona di un lucchetto su un file in Windows?**

A) File di sola lettura  
B) File crittografato con EFS  
C) File di sistema protetto  
D) File con permessi speciali  

---

## ‚úÖ **Risposte e Analisi Tecnica**

**Risposta 1: C) SMB 3.0+**  
*SMB 3.0 e versioni successive supportano crittografia AES-256 nativa per proteggere i dati in transito, fondamentale per ambienti enterprise.*

**Risposta 2: B) Il diniego esplicito prevale**  
*Nei permessi Windows, un "Deny" esplicito ha sempre precedenza su qualsiasi "Allow", anche se concesso tramite appartenenza a gruppi.*

**Risposta 3: B) Get-EffectiveAccess**  
*Questo cmdlet calcola e mostra i permessi effettivi risultanti dalla combinazione di tutti i permessi applicabili a un utente specifico.*

**Risposta 4: B) Group Policy Objects (GPO)**  
*In domini Active Directory, le GPO sono lo strumento standard per gestire centralmente permessi, condivisioni e policy di sicurezza.*

**Risposta 5: D) Windows Rights Management**  
*RMS/IRM protegge i documenti con policy che persistono anche quando i file vengono copiati o spostati su altri sistemi.*

**Risposta 6: B) File crittografato con EFS**  
*Il lucchetto indica che il file √® crittografato con Encrypting File System (EFS), accessibile solo al proprietario o a utenti autorizzati.*

---

## üöÄ **Riferimenti Tecnici Avanzati**

### Comandi PowerShell per Gestione Avanzata
```powershell
# Analisi permessi dettagliata
Get-Acl "C:\Shared" | Format-List

# Copia permessi tra cartelle
$sourceAcl = Get-Acl "C:\Source"
Set-Acl -Path "C:\Destination" -AclObject $sourceAcl

# Rimozione permessi espliciti (lascia solo ereditati)
$acl = Get-Acl "C:\Folder"
$acl.SetAccessRuleProtection($false, $false)
Set-Acl -Path "C:\Folder" -AclObject $acl

# Backup/Restore permessi
icacls "C:\Folder" /save permissions.acl /t
icacls "C:\Folder" /restore permissions.acl
```

### Monitoring e Auditing
```powershell
# Abilita auditing avanzato
auditpol /set /subcategory:"File System" /success:enable /failure:enable

# Query eventi di accesso file
Get-WinEvent -FilterHashtable @{LogName='Security'; ID=4663} | 
    Where-Object {$_.Message -like "*file.txt*"}

# Monitora condivisioni attive
Get-SmbSession | Select-Object ClientUserName, ClientComputerName, SessionId
```

### Automazione Gestione Gruppi
```powershell
# Crea gruppo e assegna permessi automaticamente
New-LocalGroup -Name "ProjectTeam_Alpha"
Add-LocalGroupMember -Group "ProjectTeam_Alpha" -Member "user1", "user2"

# Applica permessi al gruppo
$path = "C:\Projects\Alpha"
$accessRule = New-Object System.Security.AccessControl.FileSystemAccessRule(
    "ProjectTeam_Alpha", 
    "FullControl", 
    "ContainerInherit,ObjectInherit", 
    "None", 
    "Allow"
)
$acl = Get-Acl $path
$acl.SetAccessRule($accessRule)
Set-Acl -Path $path -AclObject $acl
```

---

## üîó **Collegamenti**

‚Üê [4.10 Percorsi assoluti e relativi](4.10%20Percorsi%20assoluti%20e%20relativi.md) | [4.12 Ricerca di file e cartelle ‚Üí](4.12%20Ricerca%20di%20file%20e%20cartelle.md)

---

üìö [Torna all'Indice Principale](../README.md)